{"ast":null,"code":"import _toConsumableArray from\"/Users/mickaelzana/Desktop/backstage/cards/demo-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import React,{useContext,useState,useEffect,useRef}from'react';import moment from'moment';import{connect}from'react-redux';import{Table,Input,Button,Popconfirm,Form,Modal}from'antd';import{fetchUserTransactions as _fetchUserTransactions,openModal as _openModal,selectTransaction as _selectTransaction,fetchUserCategories as _fetchUserCategories,setTotal as _setTotal}from'../actions';import ModalUI from'./ModalUI';import EditableForm from'./EditableForm';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TableUI=function TableUI(_ref){var fetchUserTransactions=_ref.fetchUserTransactions,transactions=_ref.transactions,openModal=_ref.openModal,selectTransaction=_ref.selectTransaction,fetchUserCategories=_ref.fetchUserCategories,categories=_ref.categories,setTotal=_ref.setTotal,total=_ref.total;var calcul=function calcul(){var total={};uniq_categories.forEach(function(category){var calcul=0;var filtered=transactions.filter(function(transaction){console.log('transactions ',transactions);console.log('transaction tr tr ',transaction.transaction_details.category);return transaction.transaction_details.category.includes(category.trim());});filtered.forEach(function(tr){calcul+=tr.transaction_details.total;});total[category]=calcul;console.log('total ',calcul);});return total;};useEffect(function(){fetchUserTransactions();fetchUserCategories();setTotal(calcul());},[]);var options=categories.map(function(c){return{text:c.name,value:c.name};});var onRowClick=function onRowClick(record){console.log('SELECT');selectTransaction(record);openModal();};var tr_categories=transactions.map(function(c){return c.transaction_details.category;});var uniq_categories=_toConsumableArray(new Set(tr_categories));// const calcul = () => {\n//   if(value === 'all'){\n//     let calcul = 0;\n//     transactions.forEach(tr => {\n//     calcul += tr.transaction_details.total\n//     })\n//     console.log('ALL ALL ALL', calcul);\n//     setTotal(Number(calcul).toFixed(1));\n//   }\n//   else{\n//     let calcul = 0;\n//     filteredTransactions.forEach(tr => {\n//       calcul += tr.transaction_details.total\n//     })\n//     setTotal(Number(calcul).toFixed(1));\n//     console.log('TOTAL ', calcul)\n//   }\n// }\n// calcul()\nvar columns=[{key:\"0\",title:'Vendor',dataIndex:['transaction_details','vendor'],render:function render(text){return/*#__PURE__*/_jsx(\"h2\",{children:text});}},{key:\"1\",title:'Category',dataIndex:['transaction_details','category'],filters:options,onFilter:function onFilter(value,record){return record.transaction_details.category.trim().indexOf(value.trim())===0;},render:function render(text){return/*#__PURE__*/_jsx(\"h2\",{children:text});}},{key:\"2\",title:'Total',dataIndex:['transaction_details','total'],render:function render(text){return/*#__PURE__*/_jsxs(\"h2\",{children:[text,\" \\u20AA\"]});}},{key:\"3\",title:'Date',dataIndex:['transaction_details','date'],sorter:function sorter(a,b){return new Date(a.transaction_details.date)-new Date(b.transaction_details.date);},render:function render(text){return/*#__PURE__*/_jsx(\"h2\",{children:moment(text).calendar()});}}];return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(ModalUI,{}),/*#__PURE__*/_jsx(Table,{onRow:function onRow(record,rowIndex){return{onClick:function onClick(event){return onRowClick(record);},// click row\nonDoubleClick:function onDoubleClick(event){},// double click row\nonContextMenu:function onContextMenu(event){},// right button click row\nonMouseEnter:function onMouseEnter(event){},// mouse enter row\nonMouseLeave:function onMouseLeave(event){}// mouse leave row\n};},columns:columns,dataSource:transactions,pagination:false,scroll:{y:900}})]});};var mapStateToProps=function mapStateToProps(state){return{transactions:state.transactions.transactions,categories:state.categories.categories,filter:state.transactions.filter,total:state.transactions.total};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{fetchUserTransactions:function fetchUserTransactions(){return dispatch(_fetchUserTransactions());},fetchUserCategories:function fetchUserCategories(){return dispatch(_fetchUserCategories());},selectTransaction:function selectTransaction(transaction){return dispatch(_selectTransaction(transaction));},setTotal:function setTotal(total){return dispatch(_setTotal(total));},openModal:function openModal(){return dispatch(_openModal());}};};export default connect(mapStateToProps,mapDispatchToProps)(TableUI);","map":{"version":3,"sources":["/Users/mickaelzana/Desktop/backstage/cards/demo-front/src/components/TableUI.js"],"names":["React","useContext","useState","useEffect","useRef","moment","connect","Table","Input","Button","Popconfirm","Form","Modal","fetchUserTransactions","openModal","selectTransaction","fetchUserCategories","setTotal","ModalUI","EditableForm","TableUI","transactions","categories","total","calcul","uniq_categories","forEach","category","filtered","filter","transaction","console","log","transaction_details","includes","trim","tr","options","map","c","text","name","value","onRowClick","record","tr_categories","Set","columns","key","title","dataIndex","render","filters","onFilter","indexOf","sorter","a","b","Date","date","calendar","rowIndex","onClick","event","onDoubleClick","onContextMenu","onMouseEnter","onMouseLeave","y","mapStateToProps","state","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect, useRef } from 'react';\nimport moment from 'moment'\nimport { connect } from 'react-redux';\nimport { Table, Input, Button, Popconfirm, Form, Modal } from 'antd';\nimport { fetchUserTransactions, openModal, selectTransaction, fetchUserCategories, setTotal } from '../actions';\nimport ModalUI from './ModalUI';\nimport EditableForm from './EditableForm';\n\n\nconst TableUI = ({fetchUserTransactions, transactions, openModal, selectTransaction, fetchUserCategories, categories, setTotal, total}) => {\n\n  const calcul = () => {\n    let total = {} ;\n    uniq_categories.forEach((category) => {\n      let calcul = 0;\n      const filtered = transactions.filter(transaction =>{\n        console.log('transactions ', transactions)\n        console.log('transaction tr tr ', transaction.transaction_details.category)\n        return transaction.transaction_details.category.includes(category.trim());\n      })\n      filtered.forEach(tr => {\n        calcul += tr.transaction_details.total\n      })\n      total[category] = calcul\n      console.log('total ', calcul)\n\n    })\n    return total\n    \n  }\n  useEffect(() => {\n    fetchUserTransactions()\n    fetchUserCategories()\n    setTotal(calcul())\n\n  }, []) \n\n  let options = categories.map( c => {\n    return {\n      text:c.name,\n      value:c.name\n    }\n  })\n\n  const onRowClick = record => {\n    console.log('SELECT')\n    selectTransaction(record)\n    openModal()\n  }\n\n  let tr_categories = transactions.map(c => c.transaction_details.category);\n\n  let uniq_categories = [...new Set(tr_categories)];\n \n\n\n  // const calcul = () => {\n  //   if(value === 'all'){\n  //     let calcul = 0;\n  //     transactions.forEach(tr => {\n  //     calcul += tr.transaction_details.total\n  //     })\n  //     console.log('ALL ALL ALL', calcul);\n  //     setTotal(Number(calcul).toFixed(1));\n  //   }\n  //   else{\n  //     let calcul = 0;\n  //     filteredTransactions.forEach(tr => {\n  //       calcul += tr.transaction_details.total\n  //     })\n  //     setTotal(Number(calcul).toFixed(1));\n  //     console.log('TOTAL ', calcul)\n  //   }\n  // }\n\n  // calcul()\n\n  const columns = [\n    {\n      key:\"0\",\n      title: 'Vendor',\n      dataIndex: ['transaction_details', 'vendor'],\n      render: text => <h2>{text}</h2>\n    },\n    {\n      key:\"1\",\n      title: 'Category',\n      dataIndex: ['transaction_details', 'category'],\n      filters: options,\n      onFilter: (value, record) => record.transaction_details.category.trim().indexOf(value.trim()) === 0,\n      render: text => <h2>{text}</h2>\n    },\n    {\n      key:\"2\",\n      title: 'Total',\n      dataIndex: ['transaction_details', 'total'],\n      render: text => <h2>{text} â‚ª</h2>\n      \n    },\n    {\n      key:\"3\",\n      title: 'Date',\n      dataIndex: ['transaction_details', 'date'],\n      sorter: (a, b) => new Date(a.transaction_details.date) - new Date(b.transaction_details.date),\n      render: text => <h2>{moment(text).calendar()}</h2>\n      \n    },\n  ];\n\n  \n\n \n  \n  return (\n    <div>\n      <ModalUI/>\n      <Table \n      onRow={(record, rowIndex) => {\n    return {\n      onClick: event => onRowClick(record), // click row\n      onDoubleClick: event => {}, // double click row\n      onContextMenu: event => {}, // right button click row\n      onMouseEnter: event => {}, // mouse enter row\n      onMouseLeave: event => {}, // mouse leave row\n    };\n  }}\n      columns={columns}  \n      dataSource={transactions} \n      pagination={false} \n      scroll={{ y: 900 }} \n     \n      />\n    </div>\n  )\n\n}\n\n\nconst mapStateToProps = (state) => {\n  return {\n    transactions: state.transactions.transactions,\n    categories: state.categories.categories,\n    filter: state.transactions.filter,\n    total: state.transactions.total\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    fetchUserTransactions: () => dispatch(fetchUserTransactions()),\n    fetchUserCategories: () => dispatch(fetchUserCategories()),\n    selectTransaction: (transaction) => dispatch(selectTransaction(transaction)),\n    setTotal: (total) => dispatch(setTotal(total)),\n    openModal: () => dispatch(openModal()),\n\n  }\n}\nexport default connect(mapStateToProps, mapDispatchToProps) (TableUI);"]},"metadata":{},"sourceType":"module"}